load_all()
var_left <- "housing_tenant"
var_right = " "
scale <- "DA"
region = NULL
time <- 2021
select_id <- NA
schema <- "mtl"
variables <- db_get(select = "*", from = "variables", schema = schema,
where = list(var_code = c(var_left, var_right)))
# Initialize database pool
db_pool <- db_connection()
# Ensure the pool is closed when the R session ends
on.exit(pool::poolClose(db_pool), add = TRUE)
variables <- db_get(select = "*", from = "variables", schema = schema,
where = list(var_code = c(var_left, var_right)))
variables
variables <- qs::qread("C:/Users/maxim/Unsync/curbcut-montreal/data/variables.qs")
variables
cc.buildr::db_write_prod(variables[!names(variables) %in% c("group_diff", "group_name")], "variables", schema = "mtl", primary_key = "var_code", index = "var_code")
var_left <- "housing_tenant"
var_right = " "
scale <- "DA"
region = NULL
time <- 2021
select_id <- NA
schema <- "mtl"
variables <- db_get(select = "*", from = "variables", schema = schema,
where = list(var_code = c(var_left, var_right)))
vars <- vars_build(var_left, var_right = " ", scale, time, variables = variables)
time_formatted <- vars$time
vars <- vars$vars
data <- data_get(vars, scale, region, variables = variables)
legend_render(vars = vars, scale = scale, data = data, variables = variables)
explore_graph(vars = vars, select_id = select_id, scale = scale, data = data,
time = time, schemas = schemas, lang = lang)
install()
plumber::plumb_api("cc.Rapi", "context") |> plumber::pr_run()
plumber::plumb_api("cc.Rapi", "context") |> plumber::pr_run()
install()
install()
check()
setwd(".")
install()
install()
check()
install()
install()
install()
plumber::plumb_api("cc.Rapi", "context") |> plumber::pr_run()
bench::mark(plumber::plumb_api("cc.Rapi", "context") |> plumber::pr_run())
plumber::plumb(file='inst/plumber/context/plumber.R')$run()
plumber::plumb(file='inst/plumber/context/plumber.R')$run()
install()
plumber::plumb_api("cc.Rapi", "context")$registerHooks(list(
pr_exit = function() {
pool::poolClose(db_pool)
}
)) |> plumber::pr_run()
plumber::plumb_api("cc.Rapi", "context")$registerHooks(list(
exis = function() {
pool::poolClose(db_pool)
}
)) |> plumber::pr_run()
plumber::plumb_api("cc.Rapi", "context")$registerHooks(list(
exit = function() {
pool::poolClose(db_pool)
}
)) |> plumber::pr_run()
class(plumber::plumb_api("cc.Rapi", "context"))
install()
plumber::plumb_api("cc.Rapi", "context")$registerHooks(list(
exit = function() {
pool::poolClose(db_pool)
}
)) |> plumber::pr_run()
get_from_globalenv()
get_from_globalenv
load_all()
get_from_globalenv
check()
check()
install()
load_all()
run_api()
plumber::plumb_api("cc.Rapi", "context")
plumber::plumb_api("cc.Rapi", "context")
plumber::plumb_api()
check()
install()
plumber::plumb_api()
cc.Rapi::run_api()
install()
cc.Rapi::run_api()
install()
install(
)
install()
cc.Rapi::run_api()
var_vec <- var_left
install()
load_all()
run_api()
